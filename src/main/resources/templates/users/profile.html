<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    <head th:include="partials :: head" />
</head>
<body class="main-bg">
<nav th:replace="partials :: navbar" />
<h2 class="fw-bold text-center w-auto dark-blue-bg txt-light-blue headers-font m-0">Hello <span class="headers-font" th:text="${user.getUsername()}"></span>!</h2>

<!-- Main Page Container Below -->
<div class="content min-height col justify-content-center bg-white mt-0">

    <!--SMALL BREAKPOINT-->
    <!--Tab-Pill Controller XS and SM Screens-->
    <ul class="d-xs-flex d-sm-flex d-md-none row justify-content-center nav nav-pills mx-5 mb-1 " id="pills-tab-sm" role="tablist">
        <li class="nav-item dropdown col-xs-8 col-sm-4 justify-content-center">
            <a class="nav-link dropdown-toggle text-center" data-bs-toggle="dropdown" role="button">Dashboard</a>
            <ul class="dropdown-menu">
                <li role="presentation"><a class="dropdown-item" id="pills-myaccount-tab-sm" data-bs-toggle="pill" data-bs-target="#pills-myaccount"
                                           role="tab" aria-controls="pills-myaccount" aria-selected="false">Account</a></li>
                <li role="presentation"><a class="dropdown-item" id="pills-mybooks-tab-sm" data-bs-toggle="pill" data-bs-target="#pills-mybooks"
                                           type="button" role="tab" aria-controls="pills-mybooks" aria-selected="true">Books</a></li>
                <li role="presentation"><a class="dropdown-item" id="pills-mytrades-tab-sm" data-bs-toggle="pill" data-bs-target="#pills-mytrades"
                                           type="button" role="tab" aria-controls="pills-mytrades" aria-selected="false">Trades</a></li>
                <li role="presentation"><a class="dropdown-item" id="pills-myreviews-tab-sm" data-bs-toggle="pill" data-bs-target="#pills-myreviews"
                                           type="button" role="tab" aria-controls="pills-myreviews" aria-selected="false">Reviews</a></li>
                <li role="presentation"><a class="dropdown-item" id="pills-myreads-tab-sm" data-bs-toggle="pill" data-bs-target="#pills-myreads"
                                           type="button" role="tab" aria-controls="pills-myreads" aria-selected="false">Reads</a></li>
            </ul>
        </li>
    </ul>


    <!--Medium Breakpoint-->
    <!--Tab-Pill Controller Medium and Above Screens-->
    <div class="d-none d-md-flex row justify-content-center">
        <ul class="nav nav-pills m-2 col-12 justify-content-evenly" id="pills-tab-lg" role="tablist">
            <li class="nav-item p-2" role="presentation">
                <button class="nav-link" id="pills-myaccount-tab-lg" data-bs-toggle="pill" data-bs-target="#pills-myaccount" type="button" role="tab"
                        aria-controls="pills-myaccount" aria-selected="false">
                    Account</button>
            </li>
            <li class="nav-item p-2" role="presentation">
                <button class="nav-link" id="pills-mybooks-tab-lg" data-bs-toggle="pill" data-bs-target="#pills-mybooks" type="button" role="tab"
                        aria-controls="pills-mybooks" aria-selected="true">
                    Books</button>
            </li>
            <li class="nav-item p-2" role="presentation">
                <button class="nav-link active" id="pills-mytrades-tab-lg" data-bs-toggle="pill" data-bs-target="#pills-mytrades" type="button"
                        role="tab" aria-controls="pills-mytrades" aria-selected="false">
                    Trades</button>
            </li>
            <li class="nav-item p-2" role="presentation">
                <button class="nav-link" id="pills-myreviews-tab-lg" data-bs-toggle="pill" data-bs-target="#pills-myreviews" type="button" role="tab"
                        aria-controls="pills-myreviews" aria-selected="false">
                    Reviews</button>
            </li>
            <li class="nav-item p-2" role="presentation">
                <button class="nav-link" id="pills-myreads-tab-lg" data-bs-toggle="pill" data-bs-target="#pills-myreads" type="button" role="tab"
                        aria-controls="pills-myreads" aria-selected="false">
                    My Reads</button>
            </li>
            <!--        <li class="nav-item m-2 p-3" role="presentation">-->
            <!--            <button class="nav-link" id="pills-mynotifications-tab" data-bs-toggle="pill" data-bs-target="#pills-mynotifications" type="button" role="tab" aria-controls="pills-mynotificatios" aria-selected="false">-->
            <!--                My Notifications</button>-->
            <!--        </li>-->
            <!--        <li class="nav-item m-2 p-3" role="presentation">-->
            <!--            <button class="nav-link" id="pills-mywatchlist-tab" data-bs-toggle="pill" data-bs-target="#pills-mywatchlist" type="button" role="tab" aria-controls="pills-mywatchlist" aria-selected="false">-->
            <!--                My Watchlist</button>-->
            <!--        </li>-->

        </ul>
    </div>




    <!-- Tab Content Container Below -->
    <div class="tab-content" id="pills-tabContent">
        <!-- 1st TabPanel pills-mybooks -->
            <div class="tab-pane fade" id="pills-mybooks" role="tabpanel" aria-labelledby="pills-mybooks-tab">
                <!--BOOK CARD-->
                <h3 class="book-index-header-top fw-bold text-center w-auto" >Here are the books you own!</h3>
                    <div class="shadow-sm p-3 bg-white rounded">
                        <div class="row test-media justify-content-evenly">
                            <div class="col-md-2 text-center mx-2 shadow-sm p-3 mb-3 bg-white rounded"
                                 th:each="ownedBook : ${usersBooks}" >
                                <div class="img-size d-flex justify-content-center align-items-end"
                                     th:style="'background-image:url(' +${ownedBook.getBook().getBookImg()}+')'">
                                    <a class="read-more text-decoration-none fw-light btn btn-success mb-3" th:href="|/copies/${ownedBook.getId()}|"><small>Read
                                        More</small></a>
                                </div>
                                <h6 class="book-index-headers title-bg mt-2" th:text="${ownedBook.getBook().getTitle()}"></h6>
                                <span class="span-by"><small>By: </small></span><p class="card-text text-success d-inline" th:text="${ownedBook.getBook().getAuthor().getFullname()}"></p>
                            </div>
                        </div>
                    </div>
            </div>

        <!-- 2nd TabPanel pills-myreviews-->
        <div class="tab-pane fade" id="pills-myreviews" role="tabpanel" aria-labelledby="pills-myreviews-tab">
            <h3 class="book-index-header-top fw-bold text-center w-auto" >Here are your reviews!</h3>
            <div class="d-flex flex-row flex-wrap justify-content-evenly">
                <div class="row flex-wrap review-cards-container">
                    <div class="col-sm-4 review-card-main shadow-sm p-3 mb-2 bg-body rounded" th:each="review : ${usersReviews}">
                        <div class="title-author-img-container">
                            <h6 class="book-index-headers mb-1"><span th:text="${review.getBook().getTitle()}"></span><br></h6>
                            <small><p>By: <span class="text-success" th:text="${review.getBook().getAuthor().getFullname()}"></span></p></small>
                            <img th:src="${review.getBook().getBookImg()}" th:alt="${review.getBook().getTitle()} + ' book cover.'"
                                 class="review-img mb-1">
                            <small><p class="mb-1">Rating: <span th:text="${review.getRating()}"></span> Out Of 5</p></small>
                        </div>
                        <div class="title-user-createDAte-container">
                            <p class="mb-1 fw-bold fst-italic" th:text="${review.getTitle()}"></p>
                            <small>
                                <p class="text-muted mb-1">By User: <span th:text="${review.getUser().getUsername()}"></span></p>
                                <p class="text-muted mb-1">Written On: <span th:text="${review.getCreatedDate()}"></span></p>
                            </small>
                            <a th:href="|/reviews/${review.getId()}|"><small>See this Review</small></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 3rd TabPanel pills-myreads -->
         <div class="tab-pane fade" id="pills-myreads" role="tabpanel" aria-labelledby="pills-myreads-tab">
             <h3 class="book-index-header-top fw-bold text-center w-auto" >Here is what you have read!</h3>
             <div class="row justify-content-center">

                 <div class="col-md-2 book-individual-card mb-2 shadow-sm p-3 mb-3 bg-white rounded" th:each="book : ${usersReads}">
                     <div class="img-size d-flex align-items-end justify-content-center" th:style="'background-image:url(' +${book.getBookImg()}+')'">
                         <a class="read-more text-decoration-none fw-light btn btn-success mb-3" th:href="|/books/${book.getId()}|"><small>See Book</small></a>
                     </div>
                     <h6 class="book-index-headers title-bg mt-2 mb-auto" th:text="${book.getTitle()}"></h6>
                     <span class="span-by"><small>By: </small></span><p class="card-text text-success d-inline" th:text="${book.getAuthor().getFullname()}"></p>
                 </div>
             </div>
         </div>
        <!-- 4th TabPanel pills-mytrades-->
        <div class="tab-pane fade show active" id="pills-mytrades" role="tabpanel" aria-labelledby="pills-mytrades-tab">
            <h3 class="book-index-header-top fw-bold text-center w-auto" >Here are your trades!</h3>
            <div class="row justify-content-center">
                <table class="table table-sm align-middle content">
                    <thead>
                    <tr>
                        <th scope="col">TradeBuddy Username</th>
                        <th scope="col">Book Trading</th>
                        <th scope="col">Confirm</th>
                    </tr>
                    </thead>
                    <tbody>
                        <tr th:each="item : ${tradeItems}">
                            <form th:action="@{/books/trade/received}" th:method="post">
                                <th scope="row" th:text="${item.getTrade().getItem2().getUser().getUsername()}"></th>
                                <td>MyBook To Trade: <span th:text="${item.getOwnedBook().getBook().getTitle()}"></span></td>
                                <input type="hidden" name="mybookid" id="mybookid" th:value="${item.getOwnedBook().getId()}">
                                <input type="hidden" name="item" id="item" th:value="${item.getId()}">
                                <input type="hidden" name="buddyId" id="buddyId" th:value="${item.getTrade().getItem2().getUser().getId()}">
                                <td><input type="submit" class="btn btn-sm submit-btn" value="Confirm Trade"></td>
                            </form>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- 5th TabPanel pills-mynotifications -->
<!--        <div class="tab-pane fade" id="pills-mynotifications" role="tabpanel" aria-labelledby="pills-mynotificaitons-tab">-->
<!--            <h3>Notifications</h3>-->
         <!--   <div th:each="notification : ${userNotifications}">


            </div> -->
<!--            <p>stuff about the notifications</p>-->
<!--        </div>-->
        <!-- 6th TabPanel pills-mywatchlist -->
<!--        <div class="tab-pane fade" id="pills-mywatchlist" role="tabpanel" aria-labelledby="pills-mywatchlist-tab">-->
<!--            <h3>Watchlisted Books</h3>-->


<!--        </div>-->
        <!-- 7th TabPanel pills-myaccount -->
        <div class="tab-pane fade" id="pills-myaccount" role="tabpanel" aria-labelledby="pills-myaccount-tab">

            <h3 class="book-index-header-top fw-bold text-center w-auto" >Here are your account details!</h3>
            <div>
                <div class="row justify-content-center">
                    <div class="container subcontainer border-0 mb-5 bg-body rounded h-50 w-50 mt-3 p-3 form-color">
                        <p class="summary-font m-2">Username: <span  class="summary-font txt-dark-blue" th:text="${user.getUsername()}"></span></p>
                        <p class="summary-font m-2">First Name: <span class="summary-font txt-dark-blue" th:text="${user.getFirstName()}"></span></p>
                        <p class="summary-font m-2">Last Name: <span class="summary-font txt-dark-blue" th:text="${user.getLastName()}"></span></p>
                        <p class="summary-font m-2">Email: <span class="summary-font txt-dark-blue" th:text="${user.getEmail()}"></span></p>
                        <p class="summary-font m-2">Location: <span class="summary-font txt-dark-blue" th:text="${user.getLocation()}"></span></p>
                        <div class="row justify-content-center">
                            <form class="col-4 justify-content-center my-2" th:action="@{/profile/edit}" th:method="GET">
                                <div class="text-center">
                                    <button class="btn submit-btn" type="submit">Edit Profile</button>
                                </div>
                            </form>
                        </div>
                        <div class="row justify-content-center my-2">
                            <form class="col-4 justify-content-center" th:action="@{/profile/passwordreset}" th:method="GET">
                                <div class="text-center">
                                    <button class="btn submit-btn" type="submit">Change Password</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <br>
        </div>

    </div>
</div>
<footer th:replace="partials :: footer"/>
<body th:include="partials :: scripts-bottom" />
</body>
</html>